
%Especificacion
\documentclass[14pt]{article}

%Paquetes
\usepackage[left=2cm,right=2cm,top=3cm,bottom=3cm,letterpaper]{geometry}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[spanish,activeacute]{babel}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{enumerate}
%\usepackage{tabularx}
%\usepackage{wasysym}
\usepackage{graphicx}
%\graphicspath { {tarea01/media/} }
%\usepackage{pifont}
\usepackage{titlesec}
\usepackage{enumitem}
\newcommand{\Mod}[1]{\ (\mathrm{mod}\ #1)}

%Preambulo
\title{Criptografía y seguridad \\ Tarea 5}
\author{Andrea Itzel González Vargas \\ Carlos Gerardo Acosta Hernández}
\date{Entrega: 16/05/17 \\ Facultad de Ciencias UNAM}

\titleformat*{\subsubsection}{}
\setlength\parindent{0pt}

\begin{document}
\maketitle

\subsubsection*{1. Da una definición formal de función de un solo sentido.}
\textbf{R:} Una función $f : \{0,1\}^* \to \{0,1\}^*$ es de un sólo sentido si se cumple:
\begin{itemize}
\item $\exists\; M_f \in P$, un algoritmo que calcula $f$ tal que $\forall x \;M_f(x) = f(x)$. 
\item $\forall A \in P$ algoritmo probabilístico, $\exists \;negl$, una función tal que $\Pr[Invert_{A,f}(n) = 1] \leq negl(n)$.\\
  Donde el experimento $Invert$ está definido para un algoritmo cualquiera $A$ y un valor $n$ como:
  \begin{enumerate}
  \item Se escoge uniformemente $x \in \{0,1\}^n$, y se calcula, $y = f(x)$.
  \item Se utilizan como parámetros de $A$, $1^n$ y $y$, y consideramos la salida como $x'$.
  \item La salida de este experimento es $1$ si $f(x') = y$, $0$ en caso contrario.
  \end{enumerate}
\end{itemize}

\subsubsection*{2. Acabas de intervenir la comunicación de un sistema que usa RSA.}
\begin{enumerate}[label=\alph*)]
\item Si detectas que se envió el mensaje cifrado $c$ = 10 al usuario que tiene clave pública $e$ = 5, $N$ = 35, ¿cuál es el mensaje claro? \\

  \textbf{R:} Para saber cuál es el mensaje claro debemos de encontrar la llave privada de descifrado $d$. Primero encontramos la factorización de $N$ en números primos.
  \begin{gather*}
    N = 35 = 5 \cdot 7
  \end{gather*}
  Por lo tanto:
  \begin{gather*}
    \varphi(N) = \varphi(5) \cdot \varphi(7) = (5 - 1) (7 - 1) = 4 \cdot 6 = 24
  \end{gather*}
  Ahora debemos encontrar $d$, que es el inverso de $e$ módulo $\varphi(N)$, o sea que se cumple que
  \begin{gather*}
    d \cdot e \equiv 1 \Mod{\varphi(N)}
  \end{gather*}
  substituyendo $N$ y $e$:
  \begin{gather*}
    d \cdot 5 \equiv 1 \Mod{24}
  \end{gather*}
  podemos ver entonces que:
  \begin{gather*}
    5 \cdot 5 \equiv 1 \Mod{24}
  \end{gather*}
  y por lo tanto $d = 5$. Ahora solo nos falta descifrar el mensaje, como ya sabemos $M \equiv c^d \Mod{N}$, entonces
  \begin{gather*}
    M \equiv 10^5 \Mod{35} \equiv 5 \Mod{35}
  \end{gather*}
  y por lo tanto se ha descubierto el mensaje claro $M$ = 5.
  
 \item Si la clave pública de un usuario es $e$ = 31, $N$ = 3599, ¿cuál es la clave privada correspondiente? \\
   
   \textbf{R:}
   Como en el caso anterior, procedemos a encontrar la factorización en números primos de $N$ y $\varphi$($N$).
  \begin{gather*}
    N = 3599 = 61 \cdot 59 \\
    \varphi(3599) = \varphi(61) \cdot \varphi(59) = (61 - 1) \cdot (59 - 1) = 60 \cdot 58 = 3480
  \end{gather*}
  Ahora encontramos la llave privada $d$ tal que $d \cdot 31 \equiv 1 \Mod{3480}$, es decir el inverso de $e$ módulo $\varphi(N)$. Con tal fin usamos el algoritmo de Euclides extendido. \\
  
  Primera parte:
  \begin{align*}
    3480 &= 31 \cdot 112 + 8 \\
    31 &= 8 \cdot 3 + 7 \\
    8 &= 7 \cdot 1 + 1 \\
    7 &= 1 \cdot 7 + 0
  \end{align*}
Segunda parte:
  \begin{flalign*}
    1 &= 8 + 7 (-1) \\
    &= 8 + (31 + 8 (-3)) (-1) \\
    &= 8 + 31 (-1) + 8 (3) \\
    &= 8 (4) + 31 (-1) \\
    &= ((3480 + 31 (-112)) (4) + 31 (-1) \\
    &= 3480 (4) + 31 (-449)
  \end{flalign*}
  Tenemos como resultado que:
  \begin{gather*}
    3480 (4) + 31 (-449) \equiv 1 \Mod{3480}
  \end{gather*}
  Como $3480 (4) \equiv 0 \Mod{3480}$, entonces tenemos que $31 (-449) \equiv 1 \Mod{3480}$, por lo que $d \equiv -449 \Mod{3480} \equiv 3031 \Mod{3480}$, y por lo tanto se ha encontrado la llave privada $d = 3031$.
\end{enumerate}

\subsubsection*{3. Considera el esquema de ElGamal sobre $\mathbb{Z}^*_{71}$, con elemento generador g = 7.}
\begin{enumerate}[label=\alph*)]
\item Si Bartolo tiene clave pública $Y_B$ = 3 y Alicia escoge el entero $k$ = 2, ¿cuál es el mensaje cifrado de $M$ = 30? \\
  
    \textbf{R:}  Se necesita encontrar el mensaje cifrado $c = (a, b)$, por lo que se debe calcular $a \equiv g^k \Mod{71}$ y $b \equiv Y_B^kM \Mod{71}$. Asi que
  \begin{gather*}
    a \equiv 7^2 \Mod{71} \equiv 49 \Mod{71} \\
    b \equiv 3^2 \cdot 30 \equiv 9 \cdot 30 \Mod{71} \equiv 270 \Mod{71} \equiv 57 \Mod{71}
  \end{gather*}
  Por lo tanto el mensaje cifrado $c$ es (49, 57).
  
\item Si ahora Alicia escoge otro valor para $k$ de manera que el cifrado de $M$ = 30 es la pareja (59, $C_2$), ¿cuál es el valor de $C_2$? \\
  
    \textbf{R:}  Se debe encontrar $k$ tal que $a \equiv 7^k \Mod{71} \equiv 59 \Mod{71}$, lo cual se cumple si $k$ = 3. Ahora se calcula $C_2$.
  \begin{gather*}
    C_2 \equiv Y_B^kM \Mod{71} \equiv 3^3 \cdot 30 \Mod{71} \equiv 27 \cdot 30 \Mod{71} \equiv 810 \Mod{71} \equiv 29 \Mod{71}
  \end{gather*}

  Por lo tanto $C_2$ = 29.
  
\end{enumerate}
\subsubsection*{4. Sea $N = pq$, con $p$ y $q$ primos distintos. Encuentra $p$ y $q$ si $N$ = 172205490419 y $\varphi$ ($N$) = 172204660344. (Sin factorizar directamente.)}

\subsubsection*{5. Se tiene el siguiente protocolo de intercambio de clave:}

\subsubsection*{6. Lee la sección 1 del artıículo Elliptic Curve Cryptography in Practice y escribe un resumen de lo que se exploró y los resultados.}
\textbf{R:}

\subsubsection*{7. Para el sistema de ElGamal con curvas elípticas se tienen los siguientes parámetros de una curva y 2 = x 3 + ax + b sobre F p con generador G:}

\subsubsection*{8. Se tiene la siguiente clave pública RSA}

\subsubsection*{9. Demuestra que si existe una función de un solo sentido, entonces P $\neq$ NP.}

\end{document}

