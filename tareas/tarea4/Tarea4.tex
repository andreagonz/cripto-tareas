%Especificacion
\documentclass[14pt]{article}

%Paquetes
\usepackage[left=2cm,right=2cm,top=3cm,bottom=3cm,letterpaper]{geometry}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[spanish,activeacute]{babel}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{enumerate}
%\usepackage{tabularx}
%\usepackage{wasysym}
\usepackage{graphicx}
%\graphicspath { {tarea01/media/} }
%\usepackage{pifont}
\usepackage{titlesec}
\usepackage{enumitem}
%\usepackage{coloremoji}
%Preambulo
\title{Criptograf칤a y seguridad \\ Tarea 4}
\author{Andrea Itzel Gonz치lez Vargas \\ Carlos Gerardo Acosta Hern치ndez}
\date{Entrega: 27/04/17 \\ Facultad de Ciencias UNAM}

\titleformat*{\subsubsection}{}
\setlength\parindent{0pt}

\begin{document}
\maketitle

\subsubsection*{1. Chon Hacker est치 harto de que le llegue mucha publicidad a su correo electr칩nico. Por esto ha decidido crear un filtro para abrir solamente los correos de sus amigos. El m칠todo consiste en lo siguiente:}
\begin{itemize}
\item Escoge dos emojis, $a$ y $b$, y se los manda a sus amigos.
\item Solo aceptar치 aquellos mensajes que inicien con una cadena $x$, donde esta cadena satisface la igualdad SHA256($a \parallel x$) = $b \parallel loquesea$.
\end{itemize}

\begin{enumerate}[label=\alph*)]
\item 쮺칩mo encuentras una $x$ para enviar un mensaje 춺leg칤timo췉 a Chon Hacker? \\ \\
\textbf{R:} Se itera por el espacio de mensajes posibles que empiezan con $a$. Como SHA256 acepta mensajes de longitud menor a $2^{64}$, entonces hay $\sum_{i = 0}^{63} 2^i$ mensajes posibles en total, sin embargo solo estamos tomando en cuenta los que empiezan con $a$, ya que $a$ es un emoji, ocupa 4 bytes de espacio (32 bits), por lo que nuestro espacio de mensajes posibles se reduce a $\sum_{i = 0}^{31} 2^i$. Por cada uno de estos mensajes $x$ posibles se obtiene el hash $h$ = SHA256($a \parallel x$)  y se verifica si $h$ comienza con $b$.

\item 쮼s necesario que Chon cambie $a$ y $b$ regularmente o pueden quedarse fijos? Explica. \\ \\
  \textbf{R:} Ambas opciones poseen sus respectivas desventajas. Aunque el n칰mero de colisiones por mensaje, es el mismo para todos los mensajes, por la distribuci칩n uniforme de los hashes, mantener
  los $emojis$ fijos no representar칤a una vulnerabiliad significativa ante ataques del estilo de ``birthday attack''. Recordemos que se trata de cantidades absurdamente grandes de intentos para encontrar
  una colisi칩n en un hash de 256 bits; a lo mejor, podemos descontar los primeros cuatro bytes pero
  no reducen significativamente la b칰squeda. \\

  Por otro lado, manteniendo los emojis permanentemente, un posible atacante podr칤a obtener, mediante alguna t칠cnica que requiera menos esfuerzo y tiempo, el \textit{emoji} y de esa forma, hacerse pasar por uno de los amigos de Chon Hacker. Una posible impostura
  podr칤a encaminarnos a la idea de cambiarlos con cierta regularidad, establecer un tiempo de vigencia
  para los $emojis$, pero tambi칠n debe preocuparnos entonces la mec치nica de distribuci칩n de estos $emojis$ a los amigos de Chon Hacker, el canal de comunicaci칩n por el que se los provee, de no considerar
  la seguridad podr칤a ser v칤ctima tanto 칠l como sus amigos de ataques de repetici칩n o quedar imposibilitado para comunicarse como en una denegaci칩n de servicio. \\
  
  
\item Estima cu치ntas operaciones tiene que hacer alguien para enviar un mensaje. (Aplicar SHA256 cuenta como operaci칩n b치sica.) \\ \\
  \textbf{R:}
  Para determinar cu치ntas operaciones es necesario realizar, debemos saber qu칠 tanto del espacio de mensajes debemos explorar para encontrar una $x$ apropiada que cumpla la restricci칩n de Chon Hacker.
  Comencemos por determinar el
  tama침o del subconjunto de mensajes $N \subset M$, ($M$ el espacio de mensajes) tal que $emoji_a || x \in N$. Lo consideramos un subconjunto
  propio dado que la cantidad de bits en $x$ no puede superar los $2^{64-32}$, pues el \textit{emoji}
  que nos ha proporcionado nuestro amigo Chon Hacker para la entrada en la funci칩n de hash toma 4 $bytes$ (32 $bits$), por tanto, la cantidad de combinaciones posibles en $N$ es menor que en $M$.\\
  
  Similarmente a \textbf{1.a)}, podemos calcular la cardinalidad del conjunto $N$ como:
  \begin{equation}
    |M| = \sum_{i = 0}^{2^{63}} 2^i
  \end{equation}
  \begin{equation}
    |N| = \sum_{i = 0}^{i = 2^{(64-32)-1}}2^i = \sum_{i = 0}^{i = 2^{31}}2^i
  \end{equation}
  Luego, si contamos la concatenaci칩n de $x$ con el $emoji_a$ como una de las operaciones a realizar, igualmente el c치lculo de la funci칩n hash y adem치s la comparaci칩n de los primeros cuatro $bytes$
  del resultado con el $emoji_b$, tenemos que el n칰mero total de operaciones a realizar en el
  peor de los casos ser치:
  \begin{equation}
    3 \cdot (|N| - 1)
  \end{equation}
  Pues se deben realizar las tres operaciones mencionadas, por cada $x$ posible. Si ninguna de
  las |N|-1 $x$ resultaron adecuadas para cumplir la condici칩n de Chon Hacker, idealmente, deber칤a
  encontrarse en la restante.\\
  
  A pesar de haber obtenido este resultado, no estamos del todo seguros que incluso despu칠s de este n칰mero de operaciones encontraremos la $x$ que buscamos. Consideremos el conjunto de los mensajes tal que al aplicar la funci칩n hash sobre ellos, resulta en las cadenas que Chon Hacker tiene planeado aceptar, i.e., $emoji_b || loquesea$, al que llamaremos $B$. Para calcular su tama침o, consideremos primero la cardinalidad de nuestro espacio total de mensajes $M$, dividido entre el tama침o del codominio de la funci칩n de hash; este resultado, refiere nada m치s que al n칰mero de mensajes que corresponden a cada posible hash en el codominio de la funci칩n (total de colisiones por mensaje). F칤jemonos tambi칠n en el n칰mero de posibles
  combinaciones existentes para $emoji_b || loquesea$, donde $loquesea$ tiene una longitud de 256-32 $bits$, pues $emoji_b$ ocupa ya 32 bits del mensaje. Al tener estos 32 $bits$ fijos, s칩lo nos interesa
  contar la variaci칩n en los 224 restantes, que en su total es $2^{224}$. Para cada uno de estos mensajes, existe un n칰mero igual (pues se distribuyen uniformemente) de elementos en el codominio de la funci칩n hash que le corresponde. El tama침o de nuestro conjunto $B$ estar치 dado entonces por:
  \begin{equation}
    |B| = 2^{224} \cdot \frac{|M|}{2^{256}}
  \end{equation}
  Considerando el tama침o de los conjuntos $M$, $N$ y $B$, si restamos $|M| - |B|$, obtendremos que:
  \begin{equation}
    \sum_{i = 0}^{i = 2^{31}}2^i - (2^{224} \cdot \frac{\sum_{i = 0}^{i = 2^{31}}2^i}{2^{256}}) = \sum_{i = 0}^{i = 2^{31}}2^i\cdot (1-\frac{2^{224}}{2^{256}}) = \sum_{i = 0}^{i = 2^{31}}2^i\cdot (1-\frac{1}{2^{32}})
  \end{equation}
  Comparando este resultado con $|N|$, podemos ver que (5) es mayor que (2), lo que nos lleva a considerar que dentro del conjunto $M$, cabe la posibilidad de que sus subconjuntos $N$ y $B$ sean ajenos, es decir, que
  $N \cap B = \varnothing$. Hab칤amos dicho que $B \subseteq M$ refer칤a a los mensajes que pod칤an llegar al conjunto de mensajes que Chon Hacker estaba dispuesto a aceptar, sin embargo $N$ refer칤a a los
  mensajes que ten칤amos disponibles para elegir, en caso de ser ajenos, a pesar de ejecutar todas las
  operaciones que calculamos, no encontrar칤amos una cadena $x$ adecuada para que nuestro mensaje pueda ser recibido por nuestro receptor.
\item Haz un programa para encontrar $x$ si $a$ = 游땏, $b$ = 游땚. Cuenta las operaciones que fueron necesarias y compara con la estimaci칩n anterior. Guarda $x$ en forma hexadecimal como texto, con los bytes separados por un espacio. \\ \\
  \textbf{R:}  
  
\item 쯉eguir칤a funcionando este m칠todo si ahora $b$ son dos emojis? 쯏 si $a$ son dos emojis? \\ \\
  \textbf{R:}
\end{enumerate}
\end{document}
